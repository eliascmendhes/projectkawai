

<button
  id="musicToggle"
  class="fixed bottom-4 right-4 z-50 bg-white/80 backdrop-blur-sm p-3 rounded-full shadow-lg hover:scale-110 transition-all duration-300 border-2 border-kawaii-lavender"
  aria-label="Toggle music"
>
  <svg
    id="playIcon"
    class="w-6 h-6 text-pink-600"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"
  >
    <path
      stroke-linecap="round"
      stroke-linejoin="round"
      stroke-width="2"
      d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"
    />
    <path
      stroke-linecap="round"
      stroke-linejoin="round"
      stroke-width="2"
      d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
    />
  </svg>

  <svg
    id="pauseIcon"
    class="w-6 h-6 text-pink-600 hidden"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"
  >
    <path
      stroke-linecap="round"
      stroke-linejoin="round"
      stroke-width="2"
      d="M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z"
    />
  </svg>
</button>

<audio id="bgMusic" class="hidden">
  <source src="https://streaming.radio.co/sefac315e7/listen" type="audio/mpeg">
</audio>

<script>
  let isPlaying = false;
  const audioElement = document.getElementById('bgMusic') as HTMLAudioElement;
  const musicToggle = document.getElementById('musicToggle');
  const playIcon = document.getElementById('playIcon');
  const pauseIcon = document.getElementById('pauseIcon');

  function toggleMusic() {
    if (!audioElement) return;
    
    if (isPlaying) {
      audioElement.pause();
      playIcon?.classList.remove('hidden');
      pauseIcon?.classList.add('hidden');
    } else {
      // Tenta iniciar a reprodução
      const playPromise = audioElement.play();
      
      if (playPromise !== undefined) {
        playPromise
          .then(() => {
            playIcon?.classList.add('hidden');
            pauseIcon?.classList.remove('hidden');
          })
          .catch(error => {
            console.error("Erro ao reproduzir áudio:", error);
            isPlaying = false;
          });
      }
    }
    
    isPlaying = !isPlaying;
  }

  musicToggle?.addEventListener('click', toggleMusic);

  audioElement?.addEventListener('error', (e) => {
    console.error('Erro no áudio:', e);
    isPlaying = false;
    playIcon?.classList.remove('hidden');
    pauseIcon?.classList.add('hidden');
  });
</script>
