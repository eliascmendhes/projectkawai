---
import Layout from '../layouts/Layout.astro';
import PageTitle from '../components/PageTitle.astro';
import ImageCard from '../components/ImageCard.astro';
import { images } from '../data/images';

const imagesPerPage = 6;
const totalPages = Math.ceil(images.length / imagesPerPage);
const currentPage = Astro.url.searchParams.get('page') ? parseInt(Astro.url.searchParams.get('page')) : 1;
const startIndex = (currentPage - 1) * imagesPerPage;
const endIndex = startIndex + imagesPerPage;
const currentImages = images.slice(startIndex, endIndex);
---

<Layout title="Galeria">
  <div class="max-w-5xl mx-auto p-4">
    <PageTitle title="Minha galeria ♡" />
    
    <div class="relative mb-8">
      <span class="absolute -top-4 left-4 text-2xl animate-bounce">🎀</span>
      <span class="absolute -top-4 right-4 text-2xl animate-bounce delay-75">✨</span>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
      {currentImages.map(img => (
        <ImageCard {...img} />
      ))}
    </div>

    <div class="mt-12 flex flex-wrap justify-center gap-4 font-pixel">
      {currentPage > 1 && (
        <a
          href={`?page=${currentPage - 1}`}
          class="bg-white/90 backdrop-blur-sm px-6 py-3 rounded-full border-4 border-[#FFC0CB] shadow-lg 
          hover:scale-105 hover:border-[#FF69B4] transition-all duration-300 flex items-center gap-2"
        >
          🌸 Anterior
        </a>
      )}

      <div class="flex gap-2 flex-wrap justify-center">
        {Array.from({ length: totalPages }, (_, i) => i + 1).map(pageNumber => (
          <a
            href={`?page=${pageNumber}`}
            class={`bg-white/90 backdrop-blur-sm w-12 h-12 flex items-center justify-center rounded-full border-4 
            ${pageNumber === currentPage ? 'border-[#FF69B4] bg-pink-50/50' : 'border-[#FFC0CB]'} 
            shadow-lg hover:scale-105 transition-all duration-300
            ${pageNumber === currentPage ? 'animate-pulse' : ''}`}
          >
            {pageNumber}
          </a>
        ))}
      </div>

      {currentPage < totalPages && (
        <a
          href={`?page=${currentPage + 1}`}
          class="bg-white/90 backdrop-blur-sm px-6 py-3 rounded-full border-4 border-[#FFC0CB] shadow-lg 
          hover:scale-105 hover:border-[#FF69B4] transition-all duration-300 flex items-center gap-2"
        >
          Próximo 🌸
        </a>
      )}
    </div>
  </div>
</Layout>
